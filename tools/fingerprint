#!/bin/sh
# Show relay fingerprint

FINGERPRINT_FILE="${TOR_DATA_DIR:-/var/lib/tor}/fingerprint"

if [ -f "$FINGERPRINT_FILE" ]; then
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "ğŸ”‘ Relay Fingerprint"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo ""

    NICKNAME=$(cat "$FINGERPRINT_FILE" | awk '{print $1}')
    FINGERPRINT=$(cat "$FINGERPRINT_FILE" | awk '{print $2}')

    echo "  ğŸªª Nickname:    $NICKNAME"
    echo "  ğŸ” Fingerprint: $FINGERPRINT"
    echo ""

    echo "  ğŸ“‹ Copy/paste:  $NICKNAME $FINGERPRINT"
    echo ""

    echo "  ğŸ” Find on Tor Metrics:"
    echo "     https://metrics.torproject.org/rs.html#search/$FINGERPRINT"
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo ""
else
    echo ""
    echo "â³ Fingerprint not yet generated"
    echo ""
    echo "The fingerprint is created after Tor starts. Please wait a moment"
    echo "and try again. Check status with: docker exec <container> status"
    echo ""
    exit 1
fi