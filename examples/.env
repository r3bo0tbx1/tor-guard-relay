# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Tor Relay Environment Configuration for version >=v1.1.1
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Copy this file to .env and customize for your deployment
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# BRIDGE MODE - Official Tor Project ENV Naming
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Use these for drop-in replacement of thetorproject/obfs4-bridge
# Compatible with templates/docker-compose-bridge-official.yml

# OR_PORT: Tor relay traffic port (ORPort)
# Suggested: 443 (appears as HTTPS), 9001 (standard), or any port > 1024
OR_PORT=9001

# PT_PORT: Pluggable transport port (obfs4)
# Can be any port > 1024
PT_PORT=9002

# EMAIL: Contact email address (REQUIRED)
# Used in bridge descriptor for Tor Project to contact you
EMAIL=admin@example.com

# NICKNAME: Bridge nickname (optional)
# Defaults to "DockerObfs4Bridge" if not set
NICKNAME=MyObfs4Bridge

# OBFS4_ENABLE_ADDITIONAL_VARIABLES: Enable OBFS4V_* processing
# Set to 1 to enable additional torrc options via OBFS4V_* variables
OBFS4_ENABLE_ADDITIONAL_VARIABLES=1

# OBFS4V_AddressDisableIPv6: Disable IPv6 address announcements
# 0 = Enable IPv6 (default), 1 = Disable IPv6
OBFS4V_AddressDisableIPv6=0

# OBFS4V_MaxMemInQueues: Maximum memory in queues
# Helps with high-bandwidth bridges
OBFS4V_MaxMemInQueues=1024 MB

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# GUARD/MIDDLE MODE - Our TOR_* ENV Naming
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Use these for guard/middle/exit relays
# Compatible with templates/docker-compose-guard.yml

# TOR_RELAY_MODE: Relay mode (guard, exit, or bridge)
# Default: guard
# Note: Auto-detects to "bridge" if PT_PORT is set
#TOR_RELAY_MODE=guard

# TOR_NICKNAME: Relay nickname (REQUIRED for ENV-based config)
# Must be unique across all Tor relays
#TOR_NICKNAME=MyTorRelay

# TOR_CONTACT_INFO: Contact email (REQUIRED for ENV-based config)
#TOR_CONTACT_INFO=admin@example.com

# TOR_ORPORT: ORPort for relay traffic
# Suggested: 443, 9001, or any port > 1024
#TOR_ORPORT=9001

# TOR_DIRPORT: DirPort for directory service (guard/exit only)
# Set to 0 to disable, or use standard port 9030
#TOR_DIRPORT=9030

# TOR_OBFS4_PORT: obfs4 port (bridge mode only)
#TOR_OBFS4_PORT=9002

# TOR_BANDWIDTH_RATE: Bandwidth rate limit (optional)
# Example: "10 MBytes" = 10 MB/s sustained
#TOR_BANDWIDTH_RATE=10 MBytes

# TOR_BANDWIDTH_BURST: Bandwidth burst limit (optional)
# Example: "20 MBytes" = 20 MB/s peak
#TOR_BANDWIDTH_BURST=20 MBytes

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# EXIT MODE - Additional Options
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# TOR_EXIT_POLICY: Exit policy (exit mode only)
# Default: "ExitPolicy reject *:*" (reduced exit)
# Examples:
#   - "ExitPolicy accept *:80,accept *:443,reject *:*" (HTTP/HTTPS only)
#   - "ExitPolicy accept *:*" (unrestricted exit - USE WITH CAUTION)
#TOR_EXIT_POLICY=ExitPolicy reject *:*

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# OPTIONAL: Bandwidth Accounting (All Modes)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Use OBFS4V_* prefix for official bridge naming, or add to custom torrc

# AccountingMax: Total bandwidth per period
#OBFS4V_AccountingMax=100 GBytes

# AccountingStart: When to reset accounting
# Examples: "month 1 00:00", "week 1 00:00", "day 00:00"
#OBFS4V_AccountingStart=month 1 00:00

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# CONTAINER OPTIONS
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# TZ: Container timezone (optional)
# Default: UTC
TZ=UTC

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# USAGE EXAMPLES
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Example 1: obfs4 Bridge (Official Naming)
# ──────────────────────────────────────────
# OR_PORT=9001
# PT_PORT=9002
# EMAIL=admin@example.com
# NICKNAME=MyObfs4Bridge
# OBFS4_ENABLE_ADDITIONAL_VARIABLES=1
# OBFS4V_MaxMemInQueues=1024 MB

# Example 2: Guard Relay (Our Naming)
# ──────────────────────────────────────────
# TOR_RELAY_MODE=guard
# TOR_NICKNAME=MyGuardRelay
# TOR_CONTACT_INFO=admin@example.com
# TOR_ORPORT=9001
# TOR_DIRPORT=9030
# TOR_BANDWIDTH_RATE=10 MBytes
# TOR_BANDWIDTH_BURST=20 MBytes

# Example 3: Exit Relay (Reduced Exit)
# ──────────────────────────────────────────
# TOR_RELAY_MODE=exit
# TOR_NICKNAME=MyExitRelay
# TOR_CONTACT_INFO=admin@example.com
# TOR_ORPORT=9001
# TOR_DIRPORT=9030
# TOR_EXIT_POLICY=ExitPolicy accept *:80,accept *:443,reject *:*

# Example 4: High-Bandwidth Bridge with Accounting
# ──────────────────────────────────────────
# OR_PORT=443
# PT_PORT=9002
# EMAIL=admin@example.com
# NICKNAME=HighBandwidthBridge
# OBFS4_ENABLE_ADDITIONAL_VARIABLES=1
# OBFS4V_BandwidthRate=50 MBytes
# OBFS4V_BandwidthBurst=100 MBytes
# OBFS4V_AccountingMax=500 GBytes
# OBFS4V_AccountingStart=month 1 00:00

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# NOTES
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#
# 1. ENV Variable Priority:
#    - TOR_* prefix takes precedence over official naming
#    - Official naming (OR_PORT, PT_PORT, etc.) is used as fallback
#    - You can mix both naming conventions
#
# 2. Bridge Mode Auto-Detection:
#    - If PT_PORT is set and TOR_RELAY_MODE is not, mode becomes "bridge"
#    - This ensures drop-in compatibility with official bridge config
#
# 3. OBFS4V_* Processing:
#    - Only works in bridge mode when OBFS4_ENABLE_ADDITIONAL_VARIABLES=1
#    - OBFS4V_* variables are stripped of prefix and added to torrc
#    - Example: OBFS4V_MaxMemInQueues=1024 MB → MaxMemInQueues 1024 MB in torrc
#
# 4. Port Selection:
#    - Use port 443 for ORPort in censored regions (appears as HTTPS)
#    - Standard ports: ORPort 9001, DirPort 9030, obfs4 9002
#    - Any port > 1024 works without special privileges
#
# 5. Bandwidth Units:
#    - Supported: Bytes, KBytes, MBytes, GBytes, TBytes
#    - Example: "10 MBytes" = 10 MB/s
#
# 6. Firewall Configuration Required:
#    - Allow incoming connections to OR_PORT and PT_PORT (or TOR_ORPORT/TOR_OBFS4_PORT)
#    - See docker-compose-bridge-official.yml comments for firewall examples
#
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
